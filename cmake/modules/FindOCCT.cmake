# A cmake module to find Opencascade
#------------------------------------------------------------------------------------#
# MKL includes and libraries are searched for in MKL_INCLUDE_DIR and MKL_LIB_DIR.
# If MKL_INCLUDE_DIR and MKL_LIB_DIR are not set, the module searches under 
# the environment variable MKLROOT and /opt/intel/mkl subdirectories.
#------------------------------------------------------------------------------------#
set(OCCTROOT_DIR $ENV{CASROOT})
IF (NOT OCCTROOT_DIR)
   IF (CMAKE_SYSTEM_NAME MATCHES "Linux")
       IF (EXISTS "/opt/intel/mkl")
          set(OCCTROOT_DIR "/opt/intel/mkl")
       ENDIF(EXISTS "/opt/intel/mkl")
   ENDIF()
   IF (CMAKE_SYSTEM_NAME MATCHES "Windows")
       IF (EXISTS "C:/Program\ Files\ (x86)/Intel/Composer\ XE\ 2013\ SP1/mkl")
          set(OCCTROOT_DIR "C:/Program\ Files\ (x86)/Intel/Composer\ XE\ 2013\ SP1/mkl")
       ENDIF()
   ENDIF()
ENDIF ()
message("OCCTROOT_DIR is: ${OCCTROOT_DIR}")
#------------------------------------------------------------------------------------#
# Stage 1: find the include directory
#------------------------------------------------------------------------------------#
IF (NOT OCCT_INCLUDE_DIR)
    find_path(OCCT_INCLUDE_DIR
    TopoDS_Shape.hxx
    HINTS ${OCCTROOT_DIR}
    PATH_SUFFIXES inc
    )  
	IF(OCCT_INCLUDE_DIR MATCHES "MKL_INCLUDE_DIR-NOTFOUND")
     unset(OCCT_INCLUDE_DIR CACHE)
	ENDIF()
ENDIF ()
message("OCCT_INCLUDE_DIR is: ${OCCT_INCLUDE_DIR}")
#------------------------------------------------------------------------------------#
# Stage 2: find the lib directory
#------------------------------------------------------------------------------------#	
if (NOT OCCT_LIB_DIR)
  if (OCCTROOT_DIR)
    IF (CMAKE_SYSTEM_NAME MATCHES "Windows")
	   set(EXPECT_OCCT_LIBPATH "${OCCTROOT_DIR}/win64/vc12/lib")
    endif ()	   
    if (IS_DIRECTORY ${EXPECT_OCCT_LIBPATH})
      set(OCCT_LIB_DIR ${EXPECT_OCCT_LIBPATH})
    endif ()
  endif ()
endif ()
message("OCCT_LIB_DIR is: ${OCCT_LIB_DIR}")
#------------------------------------------------------------------------------------#
# Stage 3: find the libraries
#------------------------------------------------------------------------------------#	
IF (CMAKE_SYSTEM_NAME MATCHES "Linux")
set (CMAKE_FIND_LIBRARY_SUFFIXES .a)
ENDIF()
IF (CMAKE_SYSTEM_NAME MATCHES "Windows")
set (CMAKE_FIND_LIBRARY_SUFFIXES .lib)
ENDIF()
if (OCCT_LIB_DIR)
  find_library(OCCT_LIBRARY_DRAWEXE          DRAWEXE                     ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_FWOSPLUGIN       FWOSPlugin                  ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_PTKERNEL         PTKernel                    ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKBIN            TKBin                       ${OCCT_LIB_DIR}) 
  find_library(OCCT_LIBRARY_TKBINL           TKBinL                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKBINTOBJ        TKBinTObj                     ${OCCT_LIB_DIR}) 
  find_library(OCCT_LIBRARY_TKBINXCAF        TKBinXCAF                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKBO             TKBO                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKBOOL           TKBool                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKBREP           TKBRep                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKCAF            TKCAF                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKCDF            TKCDF                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKDCAF           TKDCAF                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKDRAW           TKDraw                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKERNEL          TKernel                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKFEAT           TKFeat                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKFILLET         TKFillet                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKG2D            TKG2d                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKG3D            TKG3d                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKGEOMALGO       TKGeomAlgo                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKGEOMBASE       TKGeomBase                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKHLR            TKHLR                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKIGES           TKIGES                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKIVTK           TKIVtk                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKIVTKDRAW       TKIVtkDraw                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKLCAF           TKLCAF                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKMATH           TKMath                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKMESH           TKMesh                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKMESHVS         TKMeshVS                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKNIS            TKNIS                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKOFFSET         TKOffset                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKOPENGL         TKOpenGl                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKPCAF           TKPCAF                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKPLCAF          TKPLCAF                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKPRIM           TKPrim                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKPSHAPE         TKPShape                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKQADRAW         TKQADraw                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKSERVICE        TKService                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKSHAPESCHEM     TKShapeSchema                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKSHHEALING      TKShHealing                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKSTDLSCHEMA     TKStdLSchema                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKSTDSCHEMA      TKStdSchema                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKSTEP           TKSTEP                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKSTEP209        TKSTEP209                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKSTEPATTR       TKSTEPAttr                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKSTEPBASE       TKSTEPBase                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKSTL            TKSTL                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKTOBJ           TKTObj                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKTOBJDRAW       TKTObjDRAW                     ${OCCT_LIB_DIR}) 
  find_library(OCCT_LIBRARY_TKTOPALGO        TKTopAlgo                     ${OCCT_LIB_DIR}) 
  find_library(OCCT_LIBRARY_TKTOPTEST        TKTopTest                     ${OCCT_LIB_DIR}) 
  find_library(OCCT_LIBRARY_TKV3D            TKV3d                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKVIEWERTEST     TKViewerTest                     ${OCCT_LIB_DIR}) 
  find_library(OCCT_LIBRARY_TKVOXEL          TKVoxel                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKVRML           TKVRML                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKXCAF           TKXCAF                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKXCAFSCHEMA     TKXCAFSchema                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKXDEDRAW        TKXDEDRAW                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKXDEIGES        TKXDEIGES                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKXDESTEP        TKXDESTEP                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKXMESH          TKXMesh                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKXML            TKXml                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKXMLL           TKXmlL                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKXMLTOBJ        TKXmlTObj                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKXMLXCAF        TKXmlXCAF                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKXSBASE         TKXSBase                      ${OCCT_LIB_DIR})
  find_library(OCCT_LIBRARY_TKXSDRAW         TKXSDRAW                      ${OCCT_LIB_DIR})

  IF(CMAKE_SYSTEM_NAME MATCHES "Linux")
	set (OCCT_LIBRARIES  ${OCCT_LIBRARY_DRAWEXE} ${OCCT_LIBRARY_FWOSPLUGIN} ${OCCT_LIBRARY_PTKERNEL} ${OCCT_LIBRARY_TKBIN} ${OCCT_LIBRARY_TKBINL} ${OCCT_LIBRARY_TKBINTOBJ} ${OCCT_LIBRARY_TKBINXCAF} ${OCCT_LIBRARY_TKBO} ${OCCT_LIBRARY_TKBOOL} ${OCCT_LIBRARY_TKBREP} ${OCCT_LIBRARY_TKCAF} ${OCCT_LIBRARY_TKCDF} ${OCCT_LIBRARY_TKDCAF} ${OCCT_LIBRARY_TKDRAW} ${OCCT_LIBRARY_TKERNEL} ${OCCT_LIBRARY_TKFEAT} ${OCCT_LIBRARY_TKFILLET} ${OCCT_LIBRARY_TKG2D} ${OCCT_LIBRARY_TKG3D} ${OCCT_LIBRARY_TKGEOMALGO} ${OCCT_LIBRARY_TKGEOMBASE} ${OCCT_LIBRARY_TKHLR} ${OCCT_LIBRARY_TKIGES} ${OCCT_LIBRARY_TKIVTK} ${OCCT_LIBRARY_TKIVTKDRAW} ${OCCT_LIBRARY_TKLCAF} ${OCCT_LIBRARY_TKMATH} ${OCCT_LIBRARY_TKMESH} ${OCCT_LIBRARY_TKMESHVS} ${OCCT_LIBRARY_TKNIS} ${OCCT_LIBRARY_TKOPENGL} ${OCCT_LIBRARY_TKOFFSET} ${OCCT_LIBRARY_TKPCAF} ${OCCT_LIBRARY_TKPLCAF} ${OCCT_LIBRARY_TKPRIM} ${OCCT_LIBRARY_TKPSHAPE} ${OCCT_LIBRARY_TKQADRAW} ${OCCT_LIBRARY_TKSERVICE} ${OCCT_LIBRARY_TKSHAPESCHEM} ${OCCT_LIBRARY_TKSHHEALING} ${OCCT_LIBRARY_TKSTDLSCHEMA} ${OCCT_LIBRARY_TKSTDSCHEMA} ${OCCT_LIBRARY_TKSTEP} ${OCCT_LIBRARY_TKSTEP209} ${OCCT_LIBRARY_TKSTEPATTR} ${OCCT_LIBRARY_TKSTEPBASE} ${OCCT_LIBRARY_TKSTL} ${OCCT_LIBRARY_TKTOBJ} ${OCCT_LIBRARY_TKTOBJDRAW} ${OCCT_LIBRARY_TKTOPALGO} ${OCCT_LIBRARY_TKTOPTEST} ${OCCT_LIBRARY_TKV3D} ${OCCT_LIBRARY_TKVIEWERTEST} ${OCCT_LIBRARY_TKVOXEL} ${OCCT_LIBRARY_TKVRML} ${OCCT_LIBRARY_TKXCAF} ${OCCT_LIBRARY_TKXCAFSCHEMA} ${OCCT_LIBRARY_TKXDEDRAW} ${OCCT_LIBRARY_TKXDEIGES} ${OCCT_LIBRARY_TKXDESTEP} ${OCCT_LIBRARY_TKXMESH} ${OCCT_LIBRARY_TKXML} ${OCCT_LIBRARY_TKXMLL} ${OCCT_LIBRARY_TKXMLTOBJ} ${OCCT_LIBRARY_TKXMLXCAF} ${OCCT_LIBRARY_TKXSBASE} ${OCCT_LIBRARY_TKXSDRAW})
  ELSEIF (CMAKE_SYSTEM_NAME MATCHES "Windows")
	set (OCCT_LIBRARIES  ${OCCT_LIBRARY_DRAWEXE} ${OCCT_LIBRARY_FWOSPLUGIN} ${OCCT_LIBRARY_PTKERNEL} ${OCCT_LIBRARY_TKBIN} ${OCCT_LIBRARY_TKBINL} ${OCCT_LIBRARY_TKBINTOBJ} ${OCCT_LIBRARY_TKBINXCAF} ${OCCT_LIBRARY_TKBO} ${OCCT_LIBRARY_TKBOOL} ${OCCT_LIBRARY_TKBREP} ${OCCT_LIBRARY_TKCAF} ${OCCT_LIBRARY_TKCDF} ${OCCT_LIBRARY_TKDCAF} ${OCCT_LIBRARY_TKDRAW} ${OCCT_LIBRARY_TKERNEL} ${OCCT_LIBRARY_TKFEAT} ${OCCT_LIBRARY_TKFILLET} ${OCCT_LIBRARY_TKG2D} ${OCCT_LIBRARY_TKG3D} ${OCCT_LIBRARY_TKGEOMALGO} ${OCCT_LIBRARY_TKGEOMBASE} ${OCCT_LIBRARY_TKHLR} ${OCCT_LIBRARY_TKIGES} ${OCCT_LIBRARY_TKIVTK} ${OCCT_LIBRARY_TKIVTKDRAW} ${OCCT_LIBRARY_TKLCAF} ${OCCT_LIBRARY_TKMATH} ${OCCT_LIBRARY_TKMESH} ${OCCT_LIBRARY_TKMESHVS} ${OCCT_LIBRARY_TKNIS} ${OCCT_LIBRARY_TKOPENGL} ${OCCT_LIBRARY_TKOFFSET} ${OCCT_LIBRARY_TKPCAF} ${OCCT_LIBRARY_TKPLCAF} ${OCCT_LIBRARY_TKPRIM} ${OCCT_LIBRARY_TKPSHAPE} ${OCCT_LIBRARY_TKQADRAW} ${OCCT_LIBRARY_TKSERVICE} ${OCCT_LIBRARY_TKSHAPESCHEM} ${OCCT_LIBRARY_TKSHHEALING} ${OCCT_LIBRARY_TKSTDLSCHEMA} ${OCCT_LIBRARY_TKSTDSCHEMA} ${OCCT_LIBRARY_TKSTEP} ${OCCT_LIBRARY_TKSTEP209} ${OCCT_LIBRARY_TKSTEPATTR} ${OCCT_LIBRARY_TKSTEPBASE} ${OCCT_LIBRARY_TKSTL} ${OCCT_LIBRARY_TKTOBJ} ${OCCT_LIBRARY_TKTOBJDRAW} ${OCCT_LIBRARY_TKTOPALGO} ${OCCT_LIBRARY_TKTOPTEST} ${OCCT_LIBRARY_TKV3D} ${OCCT_LIBRARY_TKVIEWERTEST} ${OCCT_LIBRARY_TKVOXEL} ${OCCT_LIBRARY_TKVRML} ${OCCT_LIBRARY_TKXCAF} ${OCCT_LIBRARY_TKXCAFSCHEMA} ${OCCT_LIBRARY_TKXDEDRAW} ${OCCT_LIBRARY_TKXDEIGES} ${OCCT_LIBRARY_TKXDESTEP} ${OCCT_LIBRARY_TKXMESH} ${OCCT_LIBRARY_TKXML} ${OCCT_LIBRARY_TKXMLL} ${OCCT_LIBRARY_TKXMLTOBJ} ${OCCT_LIBRARY_TKXMLXCAF} ${OCCT_LIBRARY_TKXSBASE} ${OCCT_LIBRARY_TKXSDRAW})
  ELSE()
    set (OCCT_LIBRARIES "")
  ENDIF()
ENDIF()
#message("OCCT_LIBRARIES are: ${OCCT_LIBRARIES}")
# set OCCT_FOUND
include(FindPackageHandleStandardArgs)
find_package_handle_standard_args(OCCT REQUIRED_VARS OCCT_LIBRARY_DRAWEXE OCCT_LIBRARY_FWOSPLUGIN OCCT_LIBRARY_PTKERNEL OCCT_LIBRARY_TKBIN OCCT_LIBRARY_TKBINL OCCT_LIBRARY_TKBINTOBJ OCCT_LIBRARY_TKBINXCAF OCCT_LIBRARY_TKBO OCCT_LIBRARY_TKBOOL  OCCT_LIBRARY_TKBREP  OCCT_LIBRARY_TKCAF  OCCT_LIBRARY_TKCDF  OCCT_LIBRARY_TKDCAF  OCCT_LIBRARY_TKDRAW  OCCT_LIBRARY_TKERNEL  OCCT_LIBRARY_TKFEAT  OCCT_LIBRARY_TKFILLET  OCCT_LIBRARY_TKG2D  OCCT_LIBRARY_TKG3D  OCCT_LIBRARY_TKGEOMALGO  OCCT_LIBRARY_TKGEOMBASE  OCCT_LIBRARY_TKHLR  OCCT_LIBRARY_TKIGES  OCCT_LIBRARY_TKIVTK  OCCT_LIBRARY_TKIVTKDRAW  OCCT_LIBRARY_TKLCAF  OCCT_LIBRARY_TKMATH  OCCT_LIBRARY_TKMESH  OCCT_LIBRARY_TKMESHVS  OCCT_LIBRARY_TKNIS  OCCT_LIBRARY_TKOPENGL  OCCT_LIBRARY_TKOFFSET  OCCT_LIBRARY_TKPCAF  OCCT_LIBRARY_TKPLCAF  OCCT_LIBRARY_TKPRIM  OCCT_LIBRARY_TKPSHAPE  OCCT_LIBRARY_TKQADRAW  OCCT_LIBRARY_TKSERVICE  OCCT_LIBRARY_TKSHAPESCHEM  OCCT_LIBRARY_TKSHHEALING  OCCT_LIBRARY_TKSTDLSCHEMA  OCCT_LIBRARY_TKSTDSCHEMA  OCCT_LIBRARY_TKSTEP  OCCT_LIBRARY_TKSTEP209  OCCT_LIBRARY_TKSTEPATTR  OCCT_LIBRARY_TKSTEPBASE  OCCT_LIBRARY_TKSTL  OCCT_LIBRARY_TKTOBJ  OCCT_LIBRARY_TKTOBJDRAW  OCCT_LIBRARY_TKTOPALGO  OCCT_LIBRARY_TKTOPTEST  OCCT_LIBRARY_TKV3D  OCCT_LIBRARY_TKVIEWERTEST  OCCT_LIBRARY_TKVOXEL  OCCT_LIBRARY_TKVRML  OCCT_LIBRARY_TKXCAF  OCCT_LIBRARY_TKXCAFSCHEMA  OCCT_LIBRARY_TKXDEDRAW  OCCT_LIBRARY_TKXDEIGES  OCCT_LIBRARY_TKXDESTEP  OCCT_LIBRARY_TKXMESH  OCCT_LIBRARY_TKXML  OCCT_LIBRARY_TKXMLL  OCCT_LIBRARY_TKXMLTOBJ  OCCT_LIBRARY_TKXMLXCAF  OCCT_LIBRARY_TKXSBASE  OCCT_LIBRARY_TKXSDRAW)

